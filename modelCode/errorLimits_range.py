from modelCode import Model
from modelCode import data
import matplotlib.pyplot as plt
import numpy as np

vulu_file=['win_7','win_xp','win_server_2003','ubuntu_linux','Linux_kernelData','mac_os_server']
if __name__=="__main__":

    dataSet=[]

    #  获取win_7漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[0]+'.xlsx'))

    #  获取win_xp漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[1]+'.xlsx'))

    #  获取win_server_2003漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[2]+'.xlsx'))

    #  获取ubuntu_linux漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[3]+'.xlsx'))

    #  获取Linux_kernelData漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[4]+'.xlsx'))

    #  获取mac_os_server漏洞数据
    dataSet.append(data.readData('../dataSet/' + vulu_file[5] + '.xlsx'))

    #win_7漏洞数据的预测误差范围计算
    win_7_preData_PM = Model.PMGTV_Model(983.6903, 0.0911, 44.3347, 0.8906, 0.7714, 200)

    win_7_preData_RE = Model.RE_Model(1578, 0.011268, 200)

    win_7_preData_AT = Model.AT_Model(780, 3.87, 1.33, 200)

    win_7_preData_LP = Model.LP_Model(487, 0.0721, 200)

    win_7_preData_AML = Model.AML_Model(0.00017129, 905, 0.383547, 200)


    error_win_7_1 = []
    error_win_7_2 = []
    error_win_7_3 = []
    error_win_7_4 = []
    error_win_7_5 = []
    x=[]
    for i in range(len(dataSet[0])):
        x.append(i)
        error_win_7_1.append(win_7_preData_PM[i]-dataSet[0][i])
        error_win_7_2.append(win_7_preData_PM[i] - dataSet[1][i])
        error_win_7_3.append(win_7_preData_PM[i] - dataSet[2][i])
        error_win_7_4.append(win_7_preData_PM[i]-dataSet[3][i])
        error_win_7_5.append(win_7_preData_PM[i] - dataSet[4][i])


    print(error_win_7_1)
    figsize = 15, 12
    figure, ax = plt.subplots(figsize=figsize)
    plt.subplot(2,3,1)
    plt.errorbar(x,dataSet[0],error_win_7_1,color='b',marker='o',capsize=2,markerfacecolor='b',mec='g')

    plt.subplot(2, 3, 2)
    plt.errorbar(x, dataSet[0], error_win_7_2, color='b', marker='o', capsize=2, markerfacecolor='b', mec='g')

    plt.subplot(2, 3, 3)
    plt.errorbar(x, dataSet[0], error_win_7_3, color='b', marker='o', capsize=2, markerfacecolor='b', mec='g')

    plt.subplot(2, 3, 4)
    plt.errorbar(x, dataSet[0], error_win_7_4, color='b', marker='o', capsize=2, markerfacecolor='b', mec='g')

    plt.subplot(2, 3, 5)
    plt.errorbar(x, dataSet[0], error_win_7_5, color='b', marker='o', capsize=2, markerfacecolor='b', mec='g')

    plt.show()