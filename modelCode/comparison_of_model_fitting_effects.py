#!/usr/bin/env python
# -*- coding:utf8 -*-
import matplotlib.pylab as plt
import xlrd
import math
from scipy import interpolate
import numpy as np

def readData(file , index=0):
    workbook=xlrd.open_workbook(file)
    sheet=workbook.sheet_by_index(0)
    data=sheet.row_values(index)
    #读取数据
    return data


def Data_Model_line(data,line_type,name,color):
    plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正常显示中文标签

    plt.plot(data,line_type,color=color, label=name,linewidth=0.8)
    # plt.plot(data, '',color=color)
    font1 = {'family': 'Times New Roman',
             'weight': 'normal',
             'size': 15,
             }

    plt.legend(prop=font1)

def Data_Model(data,type,name,color):
    plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正常显示中文标签

    plt.plot(data,type,color=color, label=name)
    font1 = {'family': 'Times New Roman',
             'weight': 'normal',
             'size': 15,
             }

    plt.legend(prop=font1)


    font2 = {'family': 'Times New Roman',
             'weight': 'normal',
             'size': 20,
             }
    plt.title(name,font2)
    plt.xlabel('Time(month)',font2)
    plt.ylabel('Nmuber(one)',font2)

if __name__ == "__main__":
    data = []



    figsize = 14, 16
    # 设置图显示大小
    figure, ax = plt.subplots(figsize=figsize)
    mac_os_server = readData('../dataSet/' + 'mac_os_server' + '.xlsx')
    RE = readData('../dataSet/' + 'mac_os_server_RE' + '.xlsx')
    AT = readData('../dataSet/' + 'mac_os_server_AT' + '.xlsx')
    LP = readData('../dataSet/' + 'mac_os_server_LP' + '.xlsx')
    AML = readData('../dataSet/' + 'mac_os_server_AML' + '.xlsx')
    PMGTV = readData('../dataSet/' + 'mac_os_server_PMGTV' + '.xlsx')
    Data_Model(mac_os_server,'o', 'Fitting Effect', 'r')

    Data_Model_line(RE,"-.", 'RE', 'blue')
    Data_Model_line(AT,":", 'AT', 'black')
    Data_Model_line(LP, "_",'LP', 'c')
    Data_Model_line(AML, "+",'AML', 'purple')
    Data_Model_line(PMGTV,"-",'PMGTV', 'green')
    font2 = {'family': 'Times New Roman',
                      'weight': 'normal',
                     'size': 20,
                       }
    plt.xlabel('Time(month)', font2)
    plt.ylabel('Number(one)', font2)
    plt.title=('Fitting Effect',font2)
    plt.ylim(0, 450)
    plt.xlim(0,80)
    plt.grid()  # 生成网格
    plt.show()